/**
 * The MIT License (MIT)
 * Copyright (c) 2017-present Dmitry Soshnikov <dmitry.soshnikov@gmail.com>
 */

'use strict';

const GateTestUtil = require('../../gate-test-util');
const Register = require('../Register');

const {SystemClock} = require('../../Clock');

const {int16Table} = require('../../../../util/numbers');

/**
 * Testing data.
 */
const data = int16Table([
  {$clock:  -0,  in:      0,  load: 0,  out:      0},
  {$clock:  +0,  in:      0,  load: 0,  out:      0},
  {$clock:  -1,  in:      0,  load: 0,  out:      0},
  {$clock:  +1,  in:      0,  load: 1,  out:      0},
  {$clock:  -2,  in:      0,  load: 1,  out:      0},
  {$clock:  +2,  in: -32123,  load: 0,  out:      0},
  {$clock:  -3,  in: -32123,  load: 0,  out:      0},
  {$clock:  +3,  in:  11111,  load: 0,  out:      0},
  {$clock:  -4,  in:  11111,  load: 0,  out:      0},
  {$clock:  +4,  in: -32123,  load: 1,  out:      0},
  {$clock:  -5,  in: -32123,  load: 1,  out: -32123},
  {$clock:  +5,  in: -32123,  load: 1,  out: -32123},
  {$clock:  -6,  in: -32123,  load: 1,  out: -32123},
  {$clock:  +6,  in: -32123,  load: 0,  out: -32123},
  {$clock:  -7,  in: -32123,  load: 0,  out: -32123},
  {$clock:  +7,  in:  12345,  load: 1,  out: -32123},
  {$clock:  -8,  in:  12345,  load: 1,  out:  12345},
  {$clock:  +8,  in:      0,  load: 0,  out:  12345},
  {$clock:  -9,  in:      0,  load: 0,  out:  12345},
  {$clock:  +9,  in:      0,  load: 1,  out:  12345},
  {$clock: -10,  in:      0,  load: 1,  out:      0},
  {$clock: +10,  in:      1,  load: 0,  out:      0},
  {$clock: -11,  in:      1,  load: 0,  out:      0},
  {$clock: +11,  in:      1,  load: 1,  out:      0},
  {$clock: -12,  in:      1,  load: 1,  out:      1},
  {$clock: +12,  in:      2,  load: 0,  out:      1},
  {$clock: -13,  in:      2,  load: 0,  out:      1},
  {$clock: +13,  in:      2,  load: 1,  out:      1},
  {$clock: -14,  in:      2,  load: 1,  out:      2},
  {$clock: +14,  in:      4,  load: 0,  out:      2},
  {$clock: -15,  in:      4,  load: 0,  out:      2},
  {$clock: +15,  in:      4,  load: 1,  out:      2},
  {$clock: -16,  in:      4,  load: 1,  out:      4},
  {$clock: +16,  in:      8,  load: 0,  out:      4},
  {$clock: -17,  in:      8,  load: 0,  out:      4},
  {$clock: +17,  in:      8,  load: 1,  out:      4},
  {$clock: -18,  in:      8,  load: 1,  out:      8},
  {$clock: +18,  in:     16,  load: 0,  out:      8},
  {$clock: -19,  in:     16,  load: 0,  out:      8},
  {$clock: +19,  in:     16,  load: 1,  out:      8},
  {$clock: -20,  in:     16,  load: 1,  out:     16},
  {$clock: +20,  in:     32,  load: 0,  out:     16},
  {$clock: -21,  in:     32,  load: 0,  out:     16},
  {$clock: +21,  in:     32,  load: 1,  out:     16},
  {$clock: -22,  in:     32,  load: 1,  out:     32},
  {$clock: +22,  in:     64,  load: 0,  out:     32},
  {$clock: -23,  in:     64,  load: 0,  out:     32},
  {$clock: +23,  in:     64,  load: 1,  out:     32},
  {$clock: -24,  in:     64,  load: 1,  out:     64},
  {$clock: +24,  in:    128,  load: 0,  out:     64},
  {$clock: -25,  in:    128,  load: 0,  out:     64},
  {$clock: +25,  in:    128,  load: 1,  out:     64},
  {$clock: -26,  in:    128,  load: 1,  out:    128},
  {$clock: +26,  in:    256,  load: 0,  out:    128},
  {$clock: -27,  in:    256,  load: 0,  out:    128},
  {$clock: +27,  in:    256,  load: 1,  out:    128},
  {$clock: -28,  in:    256,  load: 1,  out:    256},
  {$clock: +28,  in:    512,  load: 0,  out:    256},
  {$clock: -29,  in:    512,  load: 0,  out:    256},
  {$clock: +29,  in:    512,  load: 1,  out:    256},
  {$clock: -30,  in:    512,  load: 1,  out:    512},
  {$clock: +30,  in:   1024,  load: 0,  out:    512},
  {$clock: -31,  in:   1024,  load: 0,  out:    512},
  {$clock: +31,  in:   1024,  load: 1,  out:    512},
  {$clock: -32,  in:   1024,  load: 1,  out:   1024},
  {$clock: +32,  in:   2048,  load: 0,  out:   1024},
  {$clock: -33,  in:   2048,  load: 0,  out:   1024},
  {$clock: +33,  in:   2048,  load: 1,  out:   1024},
  {$clock: -34,  in:   2048,  load: 1,  out:   2048},
  {$clock: +34,  in:   4096,  load: 0,  out:   2048},
  {$clock: -35,  in:   4096,  load: 0,  out:   2048},
  {$clock: +35,  in:   4096,  load: 1,  out:   2048},
  {$clock: -36,  in:   4096,  load: 1,  out:   4096},
  {$clock: +36,  in:   8192,  load: 0,  out:   4096},
  {$clock: -37,  in:   8192,  load: 0,  out:   4096},
  {$clock: +37,  in:   8192,  load: 1,  out:   4096},
  {$clock: -38,  in:   8192,  load: 1,  out:   8192},
  {$clock: +38,  in:  16384,  load: 0,  out:   8192},
  {$clock: -39,  in:  16384,  load: 0,  out:   8192},
  {$clock: +39,  in:  16384,  load: 1,  out:   8192},
  {$clock: -40,  in:  16384,  load: 1,  out:  16384},
  {$clock: +40,  in: -32768,  load: 0,  out:  16384},
  {$clock: -41,  in: -32768,  load: 0,  out:  16384},
  {$clock: +41,  in: -32768,  load: 1,  out:  16384},
  {$clock: -42,  in: -32768,  load: 1,  out: -32768},
  {$clock: +42,  in:     -2,  load: 0,  out: -32768},
  {$clock: -43,  in:     -2,  load: 0,  out: -32768},
  {$clock: +43,  in:     -2,  load: 1,  out: -32768},
  {$clock: -44,  in:     -2,  load: 1,  out:     -2},
  {$clock: +44,  in:     -3,  load: 0,  out:     -2},
  {$clock: -45,  in:     -3,  load: 0,  out:     -2},
  {$clock: +45,  in:     -3,  load: 1,  out:     -2},
  {$clock: -46,  in:     -3,  load: 1,  out:     -3},
  {$clock: +46,  in:     -5,  load: 0,  out:     -3},
  {$clock: -47,  in:     -5,  load: 0,  out:     -3},
  {$clock: +47,  in:     -5,  load: 1,  out:     -3},
  {$clock: -48,  in:     -5,  load: 1,  out:     -5},
  {$clock: +48,  in:     -9,  load: 0,  out:     -5},
  {$clock: -49,  in:     -9,  load: 0,  out:     -5},
  {$clock: +49,  in:     -9,  load: 1,  out:     -5},
  {$clock: -50,  in:     -9,  load: 1,  out:     -9},
  {$clock: +50,  in:    -17,  load: 0,  out:     -9},
  {$clock: -51,  in:    -17,  load: 0,  out:     -9},
  {$clock: +51,  in:    -17,  load: 1,  out:     -9},
  {$clock: -52,  in:    -17,  load: 1,  out:    -17},
  {$clock: +52,  in:    -33,  load: 0,  out:    -17},
  {$clock: -53,  in:    -33,  load: 0,  out:    -17},
  {$clock: +53,  in:    -33,  load: 1,  out:    -17},
  {$clock: -54,  in:    -33,  load: 1,  out:    -33},
  {$clock: +54,  in:    -65,  load: 0,  out:    -33},
  {$clock: -55,  in:    -65,  load: 0,  out:    -33},
  {$clock: +55,  in:    -65,  load: 1,  out:    -33},
  {$clock: -56,  in:    -65,  load: 1,  out:    -65},
  {$clock: +56,  in:   -129,  load: 0,  out:    -65},
  {$clock: -57,  in:   -129,  load: 0,  out:    -65},
  {$clock: +57,  in:   -129,  load: 1,  out:    -65},
  {$clock: -58,  in:   -129,  load: 1,  out:   -129},
  {$clock: +58,  in:   -257,  load: 0,  out:   -129},
  {$clock: -59,  in:   -257,  load: 0,  out:   -129},
  {$clock: +59,  in:   -257,  load: 1,  out:   -129},
  {$clock: -60,  in:   -257,  load: 1,  out:   -257},
  {$clock: +60,  in:   -513,  load: 0,  out:   -257},
  {$clock: -61,  in:   -513,  load: 0,  out:   -257},
  {$clock: +61,  in:   -513,  load: 1,  out:   -257},
  {$clock: -62,  in:   -513,  load: 1,  out:   -513},
  {$clock: +62,  in:  -1025,  load: 0,  out:   -513},
  {$clock: -63,  in:  -1025,  load: 0,  out:   -513},
  {$clock: +63,  in:  -1025,  load: 1,  out:   -513},
  {$clock: -64,  in:  -1025,  load: 1,  out:  -1025},
  {$clock: +64,  in:  -2049,  load: 0,  out:  -1025},
  {$clock: -65,  in:  -2049,  load: 0,  out:  -1025},
  {$clock: +65,  in:  -2049,  load: 1,  out:  -1025},
  {$clock: -66,  in:  -2049,  load: 1,  out:  -2049},
  {$clock: +66,  in:  -4097,  load: 0,  out:  -2049},
  {$clock: -67,  in:  -4097,  load: 0,  out:  -2049},
  {$clock: +67,  in:  -4097,  load: 1,  out:  -2049},
  {$clock: -68,  in:  -4097,  load: 1,  out:  -4097},
  {$clock: +68,  in:  -8193,  load: 0,  out:  -4097},
  {$clock: -69,  in:  -8193,  load: 0,  out:  -4097},
  {$clock: +69,  in:  -8193,  load: 1,  out:  -4097},
  {$clock: -70,  in:  -8193,  load: 1,  out:  -8193},
  {$clock: +70,  in: -16385,  load: 0,  out:  -8193},
  {$clock: -71,  in: -16385,  load: 0,  out:  -8193},
  {$clock: +71,  in: -16385,  load: 1,  out:  -8193},
  {$clock: -72,  in: -16385,  load: 1,  out: -16385},
  {$clock: +72,  in:  32767,  load: 0,  out: -16385},
  {$clock: -73,  in:  32767,  load: 0,  out: -16385},
  {$clock: +73,  in:  32767,  load: 1,  out: -16385},
  {$clock: -74,  in:  32767,  load: 1,  out:  32767},
]);

describe('Register', () => {
  it('Register interface', () => {
    expect(() => GateTestUtil.autoTestGate(Register))
      .not.toThrow();
  });

  it('testing data', () => {
    SystemClock.reset();

    expect(() => GateTestUtil.testTruthTable(data, Register.defaultFromSpec()))
      .not.toThrow();
  });
});